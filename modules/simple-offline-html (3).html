<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Addvalue HR System - Complete Offline</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background-color: #f5f5f5;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .header h1 {
            font-size: 28px;
            margin-bottom: 5px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 14px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #667eea;
        }
        
        .stat-card h3 {
            color: #666;
            font-size: 14px;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .stat-card .value {
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }
        
        .controls {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .controls h2 {
            margin-bottom: 15px;
            color: #333;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: #667eea;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5a6fd8;
            transform: translateY(-1px);
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
            transform: translateY(-1px);
        }
        
        .btn-warning {
            background: #ffc107;
            color: #333;
        }
        
        .btn-warning:hover {
            background: #e0a800;
            transform: translateY(-1px);
        }
        
        .search-box {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            margin-bottom: 20px;
        }
        
        .search-box:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .employee-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }
        
        .employee-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }
        
        .employee-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        
        .employee-name {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }
        
        .employee-position {
            color: #666;
            margin-bottom: 10px;
        }
        
        .employee-department {
            display: inline-block;
            background: #e3f2fd;
            color: #1976d2;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .employee-salary {
            margin-bottom: 15px;
        }
        
        .employee-actions {
            margin-top: 15px;
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }
        
        .btn-small {
            padding: 5px 10px;
            font-size: 11px;
        }
        
        .btn-danger {
            background: #dc3545;
            color: white;
        }
        
        .btn-danger:hover {
            background: #c82333;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }
        
        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 20px;
            width: 90%;
            max-width: 500px;
            border-radius: 10px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
            margin-left: 10px;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #28a745;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 5px;
            color: white;
            font-weight: bold;
            z-index: 1001;
            animation: slideIn 0.3s ease;
        }
        
        .notification.success {
            background: #28a745;
        }
        
        .notification.error {
            background: #dc3545;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        
        .salary-breakdown {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-size: 12px;
            line-height: 1.4;
        }
        
        .salary-change {
            color: #28a745;
            font-weight: bold;
            font-size: 11px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        
        table th,
        table td {
            padding: 12px;
            border: 1px solid #ddd;
            text-align: left;
        }
        
        table th {
            background: #f8f9fa;
            font-weight: bold;
        }
        
        .history-view {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 22px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .employee-grid {
                grid-template-columns: 1fr;
            }
            
            table {
                font-size: 12px;
            }
            
            table th,
            table td {
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üè¢ Addvalue HR System - Complete</h1>
            <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö Offline ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                <span class="status-indicator">
                    <span class="status-dot"></span>
                    ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï
                </span>
            </p>
        </div>

        <!-- Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <h3>üë• ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                <div class="value" id="totalEmployees">8</div>
            </div>
            <div class="stat-card">
                <h3>üí∞ ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</h3>
                <div class="value" id="avgSalary">47,250 ‡∏ø</div>
            </div>
            <div class="stat-card">
                <h3>üè¢ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ú‡∏ô‡∏Å</h3>
                <div class="value" id="totalDepartments">5</div>
            </div>
            <div class="stat-card">
                <h3>üíæ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
                <div class="value" id="lastSaved" style="color: #28a745;">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß</div>
            </div>
        </div>

        <!-- Controls -->
        <div class="controls">
            <h2>üîß ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>
            <div class="button-group">
                <button class="btn btn-primary" onclick="showEmployeeView()" id="btnEmployees">
                    üë• ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô
                </button>
                <button class="btn btn-primary" onclick="showSalaryHistoryView()" id="btnSalaryHistory">
                    üìä ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                </button>
                <button class="btn btn-primary" onclick="addEmployee()" id="btnAddEmployee">
                    ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô
                </button>
                <button class="btn btn-success" onclick="exportToJSON()">
                    üíæ Export JSON
                </button>
                <button class="btn btn-success" onclick="exportToCSV()">
                    üìä Export CSV
                </button>
                <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importFromJSON(event)">
                <button class="btn btn-warning" onclick="document.getElementById('importFile').click()">
                    üì• Import JSON
                </button>
            </div>
        </div>

        <!-- Search -->
        <input type="text" class="search-box" id="searchBox" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô... (‡∏ä‡∏∑‡πà‡∏≠, ‡∏≠‡∏µ‡πÄ‡∏°‡∏•, ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á)" onkeyup="filterEmployees()">

        <!-- Employee Grid -->
        <div class="employee-grid" id="employeeGrid">
            <!-- ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢ JavaScript -->
        </div>
    </div>

    <!-- Add/Edit Employee Modal -->
    <div id="employeeModal" class="modal">
        <div class="modal-content">
            <h2 id="modalTitle">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</h2>
            <form id="employeeForm">
                <div class="form-group">
                    <label>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• *</label>
                    <input type="text" id="employeeName" required>
                </div>
                <div class="form-group">
                    <label>‡∏≠‡∏µ‡πÄ‡∏°‡∏• *</label>
                    <input type="email" id="employeeEmail" required>
                </div>
                <div class="form-group">
                    <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</label>
                    <input type="tel" id="employeePhone">
                </div>
                <div class="form-group">
                    <label>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏á‡∏≤‡∏ô *</label>
                    <input type="text" id="employeePosition" required>
                </div>
                <div class="form-group">
                    <label>‡πÅ‡∏ú‡∏ô‡∏Å *</label>
                    <select id="employeeDepartment" required>
                        <option value="Management">Management</option>
                        <option value="Engineering">Engineering</option>
                        <option value="Technical">Technical</option>
                        <option value="Sales & Marketing">Sales & Marketing</option>
                        <option value="Administration">Administration</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (‡∏ö‡∏≤‡∏ó) *</label>
                    <input type="number" id="employeeSalary" min="0" required>
                </div>
                <div class="form-group">
                    <label>‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå *</label>
                    <input type="number" id="employeeHours" min="1" max="168" value="40" required>
                </div>
                <div class="form-group">
                    <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô *</label>
                    <input type="date" id="employeeStartDate" required>
                </div>
                <div class="form-group">
                    <label>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</label>
                    <textarea id="employeeAddress" rows="3"></textarea>
                </div>
                <div class="button-group">
                    <button type="submit" class="btn btn-primary">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                    <button type="button" class="btn btn-danger" onclick="closeModal()">‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Salary History Modal -->
    <div id="salaryHistoryModal" class="modal">
        <div class="modal-content">
            <h2 id="salaryModalTitle">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</h2>
            <form id="salaryHistoryForm">
                <div class="form-group">
                    <label>‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label>
                    <input type="text" id="salaryEmployeeName" readonly style="background: #f5f5f5;">
                    <input type="hidden" id="salaryEmployeeId">
                </div>
                <div class="form-group">
                    <label>‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° (‡∏ö‡∏≤‡∏ó)</label>
                    <input type="number" id="salaryOldAmount" readonly style="background: #f5f5f5;">
                </div>
                <div class="form-group">
                    <label>‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡∏°‡πà (‡∏ö‡∏≤‡∏ó) *</label>
                    <input type="number" id="salaryNewAmount" min="0" required>
                </div>
                <div class="form-group">
                    <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ú‡∏• *</label>
                    <input type="date" id="salaryEffectiveDate" required>
                </div>
                <div class="form-group">
                    <label>‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö *</label>
                    <select id="salaryReason" required onchange="toggleCustomReason()">
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•</option>
                        <option value="‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ">‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ</option>
                        <option value="‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏ú‡∏•‡∏á‡∏≤‡∏ô">‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏ú‡∏•‡∏á‡∏≤‡∏ô</option>
                        <option value="‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô">‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô</option>
                        <option value="‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå">‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå</option>
                        <option value="‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏ï‡∏•‡∏≤‡∏î">‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏ï‡∏•‡∏≤‡∏î</option>
                        <option value="‡∏õ‡∏£‡∏±‡∏ö‡∏•‡∏á‡∏ï‡∏≤‡∏°‡∏ú‡∏•‡∏á‡∏≤‡∏ô">‡∏õ‡∏£‡∏±‡∏ö‡∏•‡∏á‡∏ï‡∏≤‡∏°‡∏ú‡∏•‡∏á‡∏≤‡∏ô</option>
                        <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏)</option>
                    </select>
                    <input type="text" id="salaryCustomReason" style="margin-top: 5px; display: none;" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•">
                </div>
                <div class="form-group">
                    <label>‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÇ‡∏î‡∏¢ *</label>
                    <input type="text" id="salaryApprovedBy" required value="HR Manager">
                </div>
                <div class="button-group">
                    <button type="submit" class="btn btn-primary">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                    <button type="button" class="btn btn-danger" onclick="closeSalaryModal()">‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô 8 ‡∏Ñ‡∏ô (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á) + ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
        let employees = [
            {
                id: 1,
                name: "‡∏ì‡∏±‡∏ä‡∏ä‡∏≤ ‡∏¢‡∏≠‡∏î‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡πå",
                email: "natcha@hotmail.com",
                phone: "081-234-5670",
                address: "123/45 ‡∏ñ.‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏á‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå ‡πÅ‡∏Ç‡∏ß‡∏á‡∏•‡∏≤‡∏î‡∏¢‡∏≤‡∏ß ‡πÄ‡∏Ç‡∏ï‡∏à‡∏ï‡∏∏‡∏à‡∏±‡∏Å‡∏£ ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø 10900",
                dateOfBirth: "1990-05-15",
                jobPosition: "‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ò‡∏∏‡∏£‡∏Å‡∏≤‡∏£‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏¥‡∏ô",
                department: "Administration",
                employmentDate: "2013-01-01",
                salary: 14000,
                hoursPerWeek: 48,
                status: "Active",
                salaryHistory: [
                    { date: "2013-01-01", oldSalary: 0, newSalary: 12000, reason: "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô", approvedBy: "HR Manager" },
                    { date: "2020-01-01", oldSalary: 12000, newSalary: 14000, reason: "‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏≠‡∏≤‡∏¢‡∏∏‡∏á‡∏≤‡∏ô", approvedBy: "Aurnchalee Meena·∏≥" }
                ]
            },
            {
                id: 2,
                name: "Aurnchalee Meena·∏≥",
                email: "aurnchalee@addvaluesystem.com",
                phone: "082-345-6781",
                address: "456/78 ‡∏ñ.‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó ‡πÅ‡∏Ç‡∏ß‡∏á‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏ô ‡πÄ‡∏Ç‡∏ï‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢ ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø 10110",
                dateOfBirth: "1985-03-20",
                jobPosition: "Account Manager",
                department: "Management",
                employmentDate: "2000-06-15",
                salary: 50000,
                hoursPerWeek: 40,
                status: "Active",
                salaryHistory: [
                    { date: "2000-06-15", oldSalary: 0, newSalary: 35000, reason: "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô", approvedBy: "Suriyapong Yoo-om-sin" },
                    { date: "2020-01-01", oldSalary: 35000, newSalary: 45000, reason: "‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏ú‡∏•‡∏á‡∏≤‡∏ô", approvedBy: "Suriyapong Yoo-om-sin" },
                    { date: "2023-01-01", oldSalary: 45000, newSalary: 50000, reason: "‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ ‡∏ï‡∏≤‡∏°‡∏ú‡∏•‡∏á‡∏≤‡∏ô", approvedBy: "Suriyapong Yoo-om-sin" }
                ]
            },
            {
                id: 3,
                name: "Ratchaneekom Mo-on",
                email: "ratchaneekom@addvaluesystem.com",
                phone: "083-456-7892",
                address: "789/12 ‡∏ñ.‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏° 4 ‡πÅ‡∏Ç‡∏ß‡∏á‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏ô ‡πÄ‡∏Ç‡∏ï‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢ ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø 10110",
                dateOfBirth: "1988-07-10",
                jobPosition: "Telecommunication Technician",
                department: "Technical",
                employmentDate: "2015-03-01",
                salary: 24000,
                hoursPerWeek: 40,
                status: "Active",
                salaryHistory: [
                    { date: "2015-03-01", oldSalary: 0, newSalary: 20000, reason: "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô", approvedBy: "Yuttapong Eakimphon" },
                    { date: "2022-01-01", oldSalary: 20000, newSalary: 24000, reason: "‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå", approvedBy: "Yuttapong Eakimphon" }
                ]
            },
            {
                id: 4,
                name: "Sakda Wongjam",
                email: "sakda@addvaluesystem.com",
                phone: "084-567-8903",
                address: "321/65 ‡∏ñ.‡∏£‡∏±‡∏ä‡∏î‡∏≤‡∏†‡∏¥‡πÄ‡∏©‡∏Å ‡πÅ‡∏Ç‡∏ß‡∏á‡∏´‡∏±‡∏ß‡∏´‡∏°‡∏≤‡∏Å ‡πÄ‡∏Ç‡∏ï‡∏ö‡∏≤‡∏á‡∏Å‡∏∞‡∏õ‡∏¥ ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø 10240",
                dateOfBirth: "1982-11-25",
                jobPosition: "Chief Engineer",
                department: "Engineering",
                employmentDate: "2005-08-20",
                salary: 82000,
                hoursPerWeek: 40,
                status: "Active",
                salaryHistory: [
                    { date: "2005-08-20", oldSalary: 0, newSalary: 45000, reason: "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô", approvedBy: "Suriyapong Yoo-om-sin" },
                    { date: "2015-01-01", oldSalary: 45000, newSalary: 65000, reason: "‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡πÄ‡∏õ‡πá‡∏ô Senior Engineer", approvedBy: "Suriyapong Yoo-om-sin" },
                    { date: "2020-01-01", oldSalary: 65000, newSalary: 78000, reason: "‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡πÄ‡∏õ‡πá‡∏ô Chief Engineer", approvedBy: "Suriyapong Yoo-om-sin" },
                    { date: "2023-08-15", oldSalary: 78000, newSalary: 82000, reason: "‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏° ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå", approvedBy: "Suriyapong Yoo-om-sin" }
                ]
            },
            {
                id: 5,
                name: "Suriyapong Yoo-om-sin",
                email: "suriyapong@addvaluesystem.com",
                phone: "085-678-9014",
                address: "654/32 ‡∏ñ.‡∏™‡∏≤‡∏ó‡∏£ ‡πÅ‡∏Ç‡∏ß‡∏á‡∏™‡∏µ‡∏•‡∏° ‡πÄ‡∏Ç‡∏ï‡∏ö‡∏≤‡∏á‡∏£‡∏±‡∏Å ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø 10500",
                dateOfBirth: "1978-01-12",
                jobPosition: "Manager",
                department: "Management",
                employmentDate: "2001-02-01",
                salary: 120000,
                hoursPerWeek: 40,
                status: "Active",
                salaryHistory: [
                    { date: "2001-02-01", oldSalary: 0, newSalary: 60000, reason: "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô", approvedBy: "Board of Directors" },
                    { date: "2010-01-01", oldSalary: 60000, newSalary: 85000, reason: "‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡πÄ‡∏õ‡πá‡∏ô Senior Manager", approvedBy: "Board of Directors" },
                    { date: "2020-01-01", oldSalary: 85000, newSalary: 115000, reason: "‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡πÄ‡∏õ‡πá‡∏ô Manager", approvedBy: "Board of Directors" },
                    { date: "2024-01-10", oldSalary: 115000, newSalary: 120000, reason: "‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£", approvedBy: "Board of Directors" }
                ]
            },
            {
                id: 6,
                name: "Suttirak Nunsong",
                email: "suttirak@addvaluesystem.com",
                phone: "086-789-0125",
                address: "987/21 ‡∏ñ.‡∏•‡∏≤‡∏î‡∏û‡∏£‡πâ‡∏≤‡∏ß ‡πÅ‡∏Ç‡∏ß‡∏á‡∏à‡∏≠‡∏°‡∏û‡∏• ‡πÄ‡∏Ç‡∏ï‡∏à‡∏ï‡∏∏‡∏à‡∏±‡∏Å‡∏£ ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø 10900",
                dateOfBirth: "1987-09-08",
                jobPosition: "Telecommunication Engineer",
                department: "Engineering",
                employmentDate: "2010-12-15",
                salary: 33000,
                hoursPerWeek: 40,
                status: "Active",
                salaryHistory: [
                    { date: "2010-12-15", oldSalary: 0, newSalary: 25000, reason: "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô", approvedBy: "Sakda Wongjam" },
                    { date: "2018-01-01", oldSalary: 25000, newSalary: 33000, reason: "‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå", approvedBy: "Sakda Wongjam" }
                ]
            },
            {
                id: 7,
                name: "Wasupol Amonthat",
                email: "wasupol@addvaluesystem.com",
                phone: "087-890-1236",
                address: "147/89 ‡∏ñ.‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏∏‡∏£‡∏µ ‡πÅ‡∏Ç‡∏ß‡∏á‡∏°‡∏±‡∏Å‡∏Å‡∏∞‡∏™‡∏±‡∏ô ‡πÄ‡∏Ç‡∏ï‡∏£‡∏≤‡∏ä‡πÄ‡∏ó‡∏ß‡∏µ ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø 10400",
                dateOfBirth: "1989-12-03",
                jobPosition: "Sales Manager",
                department: "Sales & Marketing",
                employmentDate: "2018-05-10",
                salary: 18000,
                hoursPerWeek: 40,
                status: "Active",
                salaryHistory: [
                    { date: "2018-05-10", oldSalary: 0, newSalary: 15000, reason: "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô", approvedBy: "Suriyapong Yoo-om-sin" },
                    { date: "2022-01-01", oldSalary: 15000, newSalary: 18000, reason: "‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏ú‡∏•‡∏á‡∏≤‡∏ô", approvedBy: "Suriyapong Yoo-om-sin" }
                ]
            },
            {
                id: 8,
                name: "Yuttapong Eakimphon",
                email: "yuttapong@addvaluesystem.com",
                phone: "088-901-2347",
                address: "258/74 ‡∏ñ.‡∏≠‡πÇ‡∏®‡∏Å ‡πÅ‡∏Ç‡∏ß‡∏á‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢ ‡πÄ‡∏Ç‡∏ï‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢ ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø 10110",
                dateOfBirth: "1983-04-18",
                jobPosition: "Chief Technical",
                department: "Technical",
                employmentDate: "2001-11-01",
                salary: 37000,
                hoursPerWeek: 40,
                status: "Active",
                salaryHistory: [
                    { date: "2001-11-01", oldSalary: 0, newSalary: 25000, reason: "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô", approvedBy: "Suriyapong Yoo-om-sin" },
                    { date: "2015-01-01", oldSalary: 25000, newSalary: 32000, reason: "‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå", approvedBy: "Suriyapong Yoo-om-sin" },
                    { date: "2021-01-01", oldSalary: 32000, newSalary: 37000, reason: "‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡πÄ‡∏õ‡πá‡∏ô Chief Technical", approvedBy: "Suriyapong Yoo-om-sin" }
                ]
            }
        ];

        let currentEditId = null;
        let currentViewMode = 'employees'; // 'employees', 'salary-history'

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á
        function calculateSalaryBreakdown(monthlySalary, hoursPerWeek = 40) {
            const weeksPerMonth = 4.33; // ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢
            const workingDaysPerMonth = 22; // ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢
            
            return {
                monthly: monthlySalary,
                yearly: monthlySalary * 12,
                daily: Math.round(monthlySalary / workingDaysPerMonth),
                hourly: Math.round(monthlySalary / (hoursPerWeek * weeksPerMonth))
            };
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
        function calculateSalaryChange(oldSalary, newSalary) {
            const change = newSalary - oldSalary;
            const percentage = oldSalary > 0 ? Math.round((change / oldSalary) * 100) : 0;
            return { change, percentage };
        }

        // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å localStorage ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
        function loadData() {
            const savedData = localStorage.getItem('addvalue_hr_employees');
            if (savedData) {
                try {
                    employees = JSON.parse(savedData);
                    showNotification('‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å localStorage ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
                } catch (error) {
                    console.error('Error loading data:', error);
                    showNotification('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'error');
                }
            }
            renderEmployees();
            updateStats();
        }

        // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á localStorage
        function saveData() {
            try {
                localStorage.setItem('addvalue_hr_employees', JSON.stringify(employees));
                localStorage.setItem('addvalue_hr_lastSaved', new Date().toISOString());
                updateLastSavedTime();
                showNotification('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
            } catch (error) {
                console.error('Error saving data:', error);
                showNotification('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å', 'error');
            }
        }

        // ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
        function updateStats() {
            const activeEmployees = employees.filter(emp => emp.status === 'Active');
            const totalEmployees = activeEmployees.length;
            const totalSalary = activeEmployees.reduce((sum, emp) => sum + emp.salary, 0);
            const avgSalary = totalEmployees > 0 ? Math.round(totalSalary / totalEmployees) : 0;
            const departments = [...new Set(activeEmployees.map(emp => emp.department))];

            document.getElementById('totalEmployees').textContent = totalEmployees;
            document.getElementById('avgSalary').textContent = avgSalary.toLocaleString('th-TH') + ' ‡∏ø';
            document.getElementById('totalDepartments').textContent = departments.length;
        }

        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏ß‡∏•‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
        function updateLastSavedTime() {
            const lastSaved = localStorage.getItem('addvalue_hr_lastSaved');
            if (lastSaved) {
                const date = new Date(lastSaved);
                document.getElementById('lastSaved').textContent = date.toLocaleTimeString('th-TH');
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
        function showEmployeeView() {
            currentViewMode = 'employees';
            updateViewButtons();
            document.getElementById('searchBox').style.display = 'block';
            document.getElementById('btnAddEmployee').style.display = 'inline-flex';
            renderEmployees();
        }

        function showSalaryHistoryView() {
            currentViewMode = 'salary-history';
            updateViewButtons();
            document.getElementById('searchBox').style.display = 'none';
            document.getElementById('btnAddEmployee').style.display = 'none';
            renderAllSalaryHistory();
        }

        function updateViewButtons() {
            document.getElementById('btnEmployees').style.background = currentViewMode === 'employees' ? '#5a6fd8' : '#667eea';
            document.getElementById('btnSalaryHistory').style.background = currentViewMode === 'salary-history' ? '#5a6fd8' : '#667eea';
        }

        // ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô
        function renderEmployees(employeeList = null) {
            const employeesToShow = employeeList || employees.filter(emp => emp.status === 'Active');
            const grid = document.getElementById('employeeGrid');
            
            if (employeesToShow.length === 0) {
                grid.innerHTML = '<div style="text-align: center; padding: 40px; color: #666;"><h3>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3><p>‡∏•‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏≠‡∏∑‡πà‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</p></div>';
                return;
            }

            grid.innerHTML = employeesToShow.map(emp => {
                const salaryBreakdown = calculateSalaryBreakdown(emp.salary, emp.hoursPerWeek);
                const latestSalaryHistory = emp.salaryHistory && emp.salaryHistory.length > 1 
                    ? emp.salaryHistory[emp.salaryHistory.length - 1] 
                    : null;
                const previousSalary = latestSalaryHistory ? latestSalaryHistory.oldSalary : 0;
                const salaryChange = latestSalaryHistory ? calculateSalaryChange(previousSalary, emp.salary) : null;
                
                return `
                <div class="employee-card">
                    <div class="employee-name">${emp.name}</div>
                    <div class="employee-position">${emp.jobPosition}</div>
                    <div class="employee-department">${emp.department}</div>
                    
                    <div class="employee-salary">
                        <div style="font-size: 18px; font-weight: bold; color: #28a745; margin-bottom: 8px;">
                            üí∞ ${emp.salary.toLocaleString('th-TH')} ‡∏ø/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                        </div>
                        <div class="salary-breakdown">
                            üìÖ <strong>${salaryBreakdown.yearly.toLocaleString('th-TH')} ‡∏ø/‡∏õ‡∏µ</strong><br>
                            üóìÔ∏è ${salaryBreakdown.daily.toLocaleString('th-TH')} ‡∏ø/‡∏ß‡∏±‡∏ô<br>
                            ‚è∞ ${salaryBreakdown.hourly.toLocaleString('th-TH')} ‡∏ø/‡∏ä‡∏° (${emp.hoursPerWeek}‡∏ä‡∏°/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå)
                            ${salaryChange && salaryChange.change > 0 ? `<br><span class="salary-change">üìà ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: +${salaryChange.change.toLocaleString('th-TH')} ‡∏ø (+${salaryChange.percentage}%)</span>` : ''}
                        </div>
                    </div>
                    
                    <div style="margin-top: 10px; font-size: 12px; color: #666;">
                        üìß ${emp.email}<br>
                        üìû ${emp.phone || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}<br>
                        üìÖ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô: ${new Date(emp.employmentDate).toLocaleDateString('th-TH')}<br>
                        üìä ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô: ${emp.salaryHistory ? emp.salaryHistory.length : 0} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
                    </div>
                    
                    <div class="employee-actions">
                        <button class="btn btn-primary btn-small" onclick="editEmployee(${emp.id})">
                            ‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
                        </button>
                        <button class="btn btn-warning btn-small" onclick="viewSalaryHistory(${emp.id})">
                            üìä ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                        </button>
                        <button class="btn btn-success btn-small" onclick="addSalaryHistory(${emp.id})">
                            ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
                        </button>
                        <button class="btn btn-danger btn-small" onclick="deleteEmployee(${emp.id})">
                            üóëÔ∏è ‡∏•‡∏ö
                        </button>
                    </div>
                </div>
            `;
            }).join('');
        }

        // ‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Ñ‡∏ô‡∏´‡∏ô‡∏∂‡πà‡∏á
        function viewSalaryHistory(employeeId) {
            const employee = employees.find(emp => emp.id === employeeId);
            if (!employee || !employee.salaryHistory) return;

            const grid = document.getElementById('employeeGrid');
            
            grid.innerHTML = `
                <div class="history-view">
                    <div style="margin-bottom: 20px;">
                        <button class="btn btn-primary" onclick="renderEmployees()" style="margin-bottom: 10px;">
                            ‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô
                        </button>
                        <h2>üìä ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô: ${employee.name}</h2>
                        <p style="color: #666;">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á: ${employee.jobPosition} | ‡πÅ‡∏ú‡∏ô‡∏Å: ${employee.department}</p>
                        <button class="btn btn-success btn-small" onclick="addSalaryHistory(${employeeId})" style="margin-top: 10px;">
                            ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                        </button>
                    </div>
                    
                    <div style="overflow-x: auto;">
                        <table>
                            <thead>
                                <tr>
                                    <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                    <th>‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°</th>
                                    <th>‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡∏°‡πà</th>
                                    <th>‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á</th>
                                    <th>‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•</th>
                                    <th>‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÇ‡∏î‡∏¢</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${employee.salaryHistory.map(history => {
                                    const change = calculateSalaryChange(history.oldSalary, history.newSalary);
                                    const changeColor = change.change > 0 ? '#28a745' : change.change < 0 ? '#dc3545' : '#666';
                                    const changeIcon = change.change > 0 ? 'üìà' : change.change < 0 ? 'üìâ' : '‚ûñ';
                                    
                                    return `
                                        <tr>
                                            <td>${new Date(history.date).toLocaleDateString('th-TH')}</td>
                                            <td style="text-align: right;">${history.oldSalary.toLocaleString('th-TH')} ‡∏ø</td>
                                            <td style="text-align: right; font-weight: bold;">${history.newSalary.toLocaleString('th-TH')} ‡∏ø</td>
                                            <td style="text-align: right; color: ${changeColor}; font-weight: bold;">
                                                ${changeIcon} ${change.change > 0 ? '+' : ''}${change.change.toLocaleString('th-TH')} ‡∏ø
                                                ${change.percentage !== 0 ? `<br>(${change.percentage > 0 ? '+' : ''}${change.percentage}%)` : ''}
                                            </td>
                                            <td>${history.reason}</td>
                                            <td>${history.approvedBy}</td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </div>
                    
                    <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 5px;">
                        <h4>üìà ‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á</h4>
                        <p><strong>‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô:</strong> ${employee.salaryHistory[0].newSalary.toLocaleString('th-TH')} ‡∏ø</p>
                        <p><strong>‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô:</strong> ${employee.salary.toLocaleString('th-TH')} ‡∏ø</p>
                        <p><strong>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏£‡∏ß‡∏°:</strong> ${(employee.salary - employee.salaryHistory[0].newSalary).toLocaleString('th-TH')} ‡∏ø</p>
                        <p><strong>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏±‡∏ö:</strong> ${employee.salaryHistory.length - 1} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p>
                    </div>
                </div>
            `;
        }

        // ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        function renderAllSalaryHistory() {
            const allHistory = [];
            employees.filter(emp => emp.status === 'Active').forEach(emp => {
                if (emp.salaryHistory) {
                    emp.salaryHistory.forEach(history => {
                        allHistory.push({
                            ...history,
                            employeeName: emp.name,
                            employeeId: emp.id,
                            department: emp.department
                        });
                    });
                }
            });

            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
            allHistory.sort((a, b) => new Date(b.date) - new Date(a.date));

            const grid = document.getElementById('employeeGrid');
            
            if (allHistory.length === 0) {
                grid.innerHTML = '<div style="text-align: center; padding: 40px; color: #666;"><h3>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</h3></div>';
                return;
            }

            const totalIncreases = allHistory.filter(h => h.newSalary > h.oldSalary).length;
            const totalDecreases = allHistory.filter(h => h.newSalary < h.oldSalary).length;
            const avgIncrease = allHistory.filter(h => h.newSalary > h.oldSalary).reduce((sum, h) => sum + (h.newSalary - h.oldSalary), 0) / totalIncreases || 0;

            grid.innerHTML = `
                <div class="history-view">
                    <h2>üìä ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
                    <p style="color: #666; margin-bottom: 20px;">‡∏£‡∏ß‡∏° ${allHistory.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p>
                    
                    <div style="overflow-x: auto;">
                        <table>
                            <thead>
                                <tr>
                                    <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                    <th>‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</th>
                                    <th>‡πÅ‡∏ú‡∏ô‡∏Å</th>
                                    <th>‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°</th>
                                    <th>‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡∏°‡πà</th>
                                    <th>‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á</th>
                                    <th>‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•</th>
                                    <th>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${allHistory.map(history => {
                                    const change = calculateSalaryChange(history.oldSalary, history.newSalary);
                                    const changeColor = change.change > 0 ? '#28a745' : change.change < 0 ? '#dc3545' : '#666';
                                    const changeIcon = change.change > 0 ? 'üìà' : change.change < 0 ? 'üìâ' : '‚ûñ';
                                    
                                    return `
                                        <tr>
                                            <td>${new Date(history.date).toLocaleDateString('th-TH')}</td>
                                            <td>
                                                <button class="btn btn-primary btn-small" onclick="viewSalaryHistory(${history.employeeId})" style="padding: 2px 6px; font-size: 11px;">
                                                    ${history.employeeName}
                                                </button>
                                            </td>
                                            <td>${history.department}</td>
                                            <td style="text-align: right;">${history.oldSalary.toLocaleString('th-TH')} ‡∏ø</td>
                                            <td style="text-align: right; font-weight: bold;">${history.newSalary.toLocaleString('th-TH')} ‡∏ø</td>
                                            <td style="text-align: right; color: ${changeColor}; font-weight: bold;">
                                                ${changeIcon} ${change.change > 0 ? '+' : ''}${change.change.toLocaleString('th-TH')} ‡∏ø
                                                ${change.percentage !== 0 ? `<br>(${change.percentage > 0 ? '+' : ''}${change.percentage}%)` : ''}
                                            </td>
                                            <td>${history.reason}</td>
                                            <td style="text-align: center;">
                                                <button class="btn btn-success btn-small" onclick="addSalaryHistory(${history.employeeId})" style="padding: 2px 6px; font-size: 11px;">
                                                    ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°
                                                </button>
                                            </td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </div>
                    
                    <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 5px;">
                        <h4>üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div>
                                <strong>‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô:</strong> ${totalIncreases} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
                            </div>
                            <div>
                                <strong>‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏•‡∏á:</strong> ${totalDecreases} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
                            </div>
                            <div>
                                <strong>‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô:</strong> ${Math.round(avgIncrease).toLocaleString('th-TH')} ‡∏ø
                            </div>
                            <div>
                                <strong>‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î:</strong> ${new Date(allHistory[0].date).toLocaleDateString('th-TH')}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≠‡∏á‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô
        function filterEmployees() {
            const searchTerm = document.getElementById('searchBox').value.toLowerCase();
            const filtered = employees.filter(emp => 
                emp.status === 'Active' && (
                    emp.name.toLowerCase().includes(searchTerm) ||
                    emp.email.toLowerCase().includes(searchTerm) ||
                    emp.jobPosition.toLowerCase().includes(searchTerm) ||
                    emp.department.toLowerCase().includes(searchTerm)
                )
            );
            renderEmployees(filtered);
        }

        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà
        function addEmployee() {
            currentEditId = null;
            document.getElementById('modalTitle').textContent = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà';
            document.getElementById('employeeForm').reset();
            document.getElementById('employeeStartDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('employeeHours').value = 40;
            document.getElementById('employeeModal').style.display = 'block';
        }

        // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô
        function editEmployee(id) {
            const employee = employees.find(emp => emp.id === id);
            if (!employee) return;

            currentEditId = id;
            document.getElementById('modalTitle').textContent = '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô';
            document.getElementById('employeeName').value = employee.name;
            document.getElementById('employeeEmail').value = employee.email;
            document.getElementById('employeePhone').value = employee.phone || '';
            document.getElementById('employeePosition').value = employee.jobPosition;
            document.getElementById('employeeDepartment').value = employee.department;
            document.getElementById('employeeSalary').value = employee.salary;
            document.getElementById('employeeHours').value = employee.hoursPerWeek || 40;
            document.getElementById('employeeStartDate').value = employee.employmentDate;
            document.getElementById('employeeAddress').value = employee.address || '';
            document.getElementById('employeeModal').style.display = 'block';
        }

        // ‡∏•‡∏ö‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô
        function deleteEmployee(id) {
            const employee = employees.find(emp => emp.id === id);
            if (!employee) return;

            if (confirm(`‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô "${employee.name}" ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`)) {
                const index = employees.findIndex(emp => emp.id === id);
                employees[index].status = 'Inactive';
                saveData();
                renderEmployees();
                updateStats();
                showNotification('‡∏•‡∏ö‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
            }
        }

        // ‡∏õ‡∏¥‡∏î Modal
        function closeModal() {
            document.getElementById('employeeModal').style.display = 'none';
            currentEditId = null;
        }

        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
        function addSalaryHistory(employeeId) {
            const employee = employees.find(emp => emp.id === employeeId);
            if (!employee) return;

            document.getElementById('salaryEmployeeName').value = employee.name;
            document.getElementById('salaryEmployeeId').value = employeeId;
            document.getElementById('salaryOldAmount').value = employee.salary;
            document.getElementById('salaryNewAmount').value = '';
            document.getElementById('salaryEffectiveDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('salaryReason').value = '';
            document.getElementById('salaryCustomReason').value = '';
            document.getElementById('salaryCustomReason').style.display = 'none';
            document.getElementById('salaryApprovedBy').value = 'HR Manager';
            document.getElementById('salaryHistoryModal').style.display = 'block';
        }

        // ‡∏õ‡∏¥‡∏î Modal ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
        function closeSalaryModal() {
            document.getElementById('salaryHistoryModal').style.display = 'none';
        }

        // ‡πÅ‡∏™‡∏î‡∏á/‡∏ã‡πà‡∏≠‡∏ô ‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÅ‡∏ö‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏≠‡∏á
        function toggleCustomReason() {
            const reason = document.getElementById('salaryReason').value;
            const customField = document.getElementById('salaryCustomReason');
            
            if (reason === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') {
                customField.style.display = 'block';
                customField.required = true;
            } else {
                customField.style.display = 'none';
                customField.required = false;
                customField.value = '';
            }
        }

        // Export ‡πÄ‡∏õ‡πá‡∏ô JSON
        function exportToJSON() {
            const data = {
                employees: employees,
                exportedAt: new Date().toISOString(),
                version: "2.0"
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `addvalue_hr_complete_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('Export JSON ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
        }

        // Export ‡πÄ‡∏õ‡πá‡∏ô CSV
        function exportToCSV() {
            const activeEmployees = employees.filter(emp => emp.status === 'Active');
            const headers = ['ID', '‡∏ä‡∏∑‡πà‡∏≠', '‡∏≠‡∏µ‡πÄ‡∏°‡∏•', '‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á', '‡πÅ‡∏ú‡∏ô‡∏Å', '‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô', '‡∏ä‡∏°/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå', '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô', '‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô'];
            const csvData = [
                headers.join(','),
                ...activeEmployees.map(emp => [
                    emp.id,
                    `"${emp.name}"`,
                    emp.email,
                    `"${emp.jobPosition}"`,
                    `"${emp.department}"`,
                    emp.salary,
                    emp.hoursPerWeek || 40,
                    emp.employmentDate,
                    emp.salaryHistory ? emp.salaryHistory.length : 0
                ].join(','))
            ].join('\n');

            const blob = new Blob([csvData], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `addvalue_hr_employees_${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('Export CSV ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
        }

        // Import ‡∏à‡∏≤‡∏Å JSON
        function importFromJSON(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    if (data.employees && Array.isArray(data.employees)) {
                        employees = data.employees;
                        saveData();
                        if (currentViewMode === 'employees') {
                            renderEmployees();
                        } else {
                            renderAllSalaryHistory();
                        }
                        updateStats();
                        showNotification('Import ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
                    } else {
                        showNotification('‡πÑ‡∏ü‡∏•‡πå JSON ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', 'error');
                    }
                } catch (error) {
                    console.error('Import error:', error);
                    showNotification('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ Import', 'error');
                }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Form
        document.getElementById('employeeForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = {
                name: document.getElementById('employeeName').value,
                email: document.getElementById('employeeEmail').value,
                phone: document.getElementById('employeePhone').value,
                jobPosition: document.getElementById('employeePosition').value,
                department: document.getElementById('employeeDepartment').value,
                salary: parseInt(document.getElementById('employeeSalary').value),
                hoursPerWeek: parseInt(document.getElementById('employeeHours').value),
                employmentDate: document.getElementById('employeeStartDate').value,
                address: document.getElementById('employeeAddress').value
            };

            if (currentEditId) {
                // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô
                const index = employees.findIndex(emp => emp.id === currentEditId);
                employees[index] = { ...employees[index], ...formData };
                showNotification('‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
            } else {
                // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà
                const newId = Math.max(...employees.map(emp => emp.id), 0) + 1;
                const newEmployee = {
                    id: newId,
                    ...formData,
                    status: 'Active',
                    salaryHistory: [{
                        date: formData.employmentDate,
                        oldSalary: 0,
                        newSalary: formData.salary,
                        reason: '‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô',
                        approvedBy: 'HR Manager'
                    }]
                };
                employees.push(newEmployee);
                showNotification('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
            }

            saveData();
            if (currentViewMode === 'employees') {
                renderEmployees();
            }
            updateStats();
            closeModal();
        });

        // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Form ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
        document.getElementById('salaryHistoryForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const employeeId = parseInt(document.getElementById('salaryEmployeeId').value);
            const oldSalary = parseInt(document.getElementById('salaryOldAmount').value);
            const newSalary = parseInt(document.getElementById('salaryNewAmount').value);
            const effectiveDate = document.getElementById('salaryEffectiveDate').value;
            const reason = document.getElementById('salaryReason').value === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' 
                ? document.getElementById('salaryCustomReason').value 
                : document.getElementById('salaryReason').value;
            const approvedBy = document.getElementById('salaryApprovedBy').value;

            // ‡∏´‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô
            const employeeIndex = employees.findIndex(emp => emp.id === employeeId);
            if (employeeIndex === -1) {
                showNotification('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô', 'error');
                return;
            }

            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
            if (!employees[employeeIndex].salaryHistory) {
                employees[employeeIndex].salaryHistory = [];
            }

            employees[employeeIndex].salaryHistory.push({
                date: effectiveDate,
                oldSalary: oldSalary,
                newSalary: newSalary,
                reason: reason,
                approvedBy: approvedBy
            });

            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
            employees[employeeIndex].salary = newSalary;

            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
            employees[employeeIndex].salaryHistory.sort((a, b) => new Date(a.date) - new Date(b.date));

            saveData();
            showNotification('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
            closeSalaryModal();
            
            // Refresh view
            if (currentViewMode === 'salary-history') {
                renderAllSalaryHistory();
            } else {
                viewSalaryHistory(employeeId);
            }
            updateStats();
        });

        // ‡∏õ‡∏¥‡∏î Modal ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ô‡∏≠‡∏Å Modal
        window.onclick = function(event) {
            const employeeModal = document.getElementById('employeeModal');
            const salaryModal = document.getElementById('salaryHistoryModal');
            
            if (event.target === employeeModal) {
                closeModal();
            }
            if (event.target === salaryModal) {
                closeSalaryModal();
            }
        }

        // Auto-save ‡∏ó‡∏∏‡∏Å 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
        setInterval(function() {
            saveData();
        }, 30000);

        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            updateLastSavedTime();
            showEmployeeView(); // ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö
            setTimeout(function() {
                showNotification('‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö Addvalue HR Complete - ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô', 'success');
            }, 500);
        });
    </script>
</body>
</html>