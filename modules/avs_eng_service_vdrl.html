<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AVS Eng Service VDRL</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: #f5f7fa;
            color: #333;
        }
        
        /* Header */
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .stats {
            display: flex;
            gap: 30px;
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .stat-label {
            font-size: 0.8rem;
            opacity: 0.9;
        }
        
        /* Controls */
        .controls {
            background: white;
            padding: 1.5rem 2rem;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .controls-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            align-items: center;
        }
        
        input, select, button {
            padding: 0.6rem 1rem;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        #searchInput {
            flex: 1;
            min-width: 250px;
        }
        
        button {
            background: #667eea;
            color: white;
            cursor: pointer;
            border: none;
            transition: all 0.3s;
        }
        
        button:hover {
            background: #5a67d8;
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background: #48bb78;
        }
        
        .btn-secondary:hover {
            background: #38a169;
        }
        
        .btn-danger {
            background: #f56565;
        }
        
        .btn-danger:hover {
            background: #e53e3e;
        }
        
        /* Main Content */
        .content {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
        }
        
        /* Table */
        .table-container {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th {
            background: #f7f8fa;
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            color: #666;
            border-bottom: 2px solid #e0e0e0;
            position: sticky;
            top: 0;
        }
        
        td {
            padding: 0.8rem 1rem;
            border-bottom: 1px solid #f0f0f0;
        }
        
        tr:hover {
            background: #f9fafb;
        }
        
        .code-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 12px;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .status-active {
            background: #d4f8e8;
            color: #065f46;
        }
        
        .status-inactive {
            background: #fee2e2;
            color: #991b1b;
        }
        
        /* Action buttons */
        .actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .btn-sm {
            padding: 0.3rem 0.6rem;
            font-size: 12px;
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }
        
        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            margin-bottom: 1.5rem;
        }
        
        .modal-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
        }
        
        .form-group {
            margin-bottom: 1rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.3rem;
            font-weight: 500;
            color: #555;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 0.6rem;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }
        
        .modal-footer {
            margin-top: 1.5rem;
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }
        
        /* Success message */
        .success-message {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #48bb78;
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: none;
            animation: slideIn 0.3s ease-out;
        }
        
        .success-message.show {
            display: block;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* Code colors */
        .code-VDR { background: #d4edda; color: #155724; }
        .code-SCD { background: #fff3cd; color: #856404; }
        .code-MPR { background: #d1ecf1; color: #0c5460; }
        .code-LIS { background: #f8d7da; color: #721c24; }
        .code-CAL { background: #e7e3f8; color: #4a3c7a; }
        .code-CER { background: #fff8dc; color: #7a6800; }
        .code-PDR { background: #d4f4e7; color: #0f5132; }
        .code-RPT { background: #fde2e2; color: #842029; }
        .code-DWG { background: #e3f2fd; color: #0d47a1; }
        .code-PLN { background: #fce4ec; color: #880e4f; }
        .code-ITP { background: #f3e5f5; color: #4a148c; }
        .code-SPIR { background: #efebe9; color: #3e2723; }
        .code-MTC { background: #e0f2f1; color: #004d40; }
        .code-INV { background: #fff9c4; color: #f57f17; }
        .code-IRN { background: #e8f5e9; color: #1b5e20; }
        .code-RGT { background: #fbe9e7; color: #bf360c; }
        .code-MOM { background: #e1f5fe; color: #01579b; }
        .code-TBL { background: #f3e5f5; color: #4a148c; }
        .code-GA { background: #e8f5e9; color: #2e7d32; }
        .code-SCH { background: #e3f2fd; color: #1565c0; }
        .code-DTS { background: #fff3e0; color: #e65100; }
        .code-PHI { background: #fce4ec; color: #c2185b; }
        .code-WIR { background: #e0f2f1; color: #00796b; }
        
        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
            }
            
            .controls-content {
                flex-direction: column;
            }
            
            #searchInput {
                width: 100%;
            }
            
            .table-container {
                overflow-x: auto;
            }
            
            table {
                min-width: 800px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <div class="logo">
                <span>üìä</span>
                <span>AVS Eng Service VDRL</span>
            </div>
            <div class="stats">
                <div class="stat">
                    <div class="stat-value" id="totalDocs">44</div>
                    <div class="stat-label">Total Documents</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="activeCount">44</div>
                    <div class="stat-label">Active</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="categoryCount">22</div>
                    <div class="stat-label">Categories</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Controls -->
    <div class="controls">
        <div class="controls-content">
            <input type="text" id="searchInput" placeholder="üîç Search documents...">
            
            <select id="categoryFilter">
                <option value="">All Categories</option>
            </select>
            
            <select id="statusFilter">
                <option value="">All Status</option>
                <option value="Active">Active</option>
                <option value="Inactive">Inactive</option>
            </select>
            
            <button class="btn-secondary" onclick="showAddModal()">‚ûï Add Document</button>
            <button onclick="exportCSV()">üì• Export CSV</button>
            <button onclick="exportJSON()">üì• Export JSON</button>
            <button onclick="loadDocuments()">üîÑ Refresh</button>
        </div>
    </div>
    
    <!-- Main Content -->
    <div class="content">
        <div class="table-container">
            <table id="documentsTable">
                <thead>
                    <tr>
                        <th width="5%">ID</th>
                        <th width="8%">Code</th>
                        <th width="30%">Document No.</th>
                        <th width="35%">Title</th>
                        <th width="8%">Status</th>
                        <th width="6%">Rev</th>
                        <th width="8%">Actions</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                </tbody>
            </table>
        </div>
    </div>
    
    <!-- Add/Edit Modal -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Add Document</h2>
            </div>
            
            <form id="documentForm">
                <input type="hidden" id="docId">
                
                <div class="form-group">
                    <label>VDRS Code *</label>
                    <select id="vdrsCode" required>
                        <option value="">Select Code</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Document Number *</label>
                    <input type="text" id="docNo" required placeholder="e.g., TH-ART-3C-AWP39-TEQ-TEL-XXX-0001">
                </div>
                
                <div class="form-group">
                    <label>Document Title *</label>
                    <textarea id="docTitle" required placeholder="Enter document title"></textarea>
                </div>
                
                <div class="form-group">
                    <label>Status</label>
                    <select id="docStatus">
                        <option value="Active">Active</option>
                        <option value="Inactive">Inactive</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Revision</label>
                    <input type="text" id="docRevision" value="A" placeholder="e.g., A, B, C">
                </div>
            </form>
            
            <div class="modal-footer">
                <button type="button" onclick="closeModal()">Cancel</button>
                <button type="button" class="btn-secondary" onclick="saveDocument()">Save</button>
            </div>
        </div>
    </div>
    
    <!-- Success Message -->
    <div id="successMessage" class="success-message">
        <span id="successText">Operation completed successfully!</span>
    </div>
    
    <script>
        // =============== LOCAL DATABASE (Standalone Mode) ===============
        // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô LocalStorage ‡∏Ç‡∏≠‡∏á Browser
        
        let documents = [];
        const STORAGE_KEY = 'avs_vdrl_documents';
        
        // ‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
        const codeCategories = {
            'VDR': 'Document Register',
            'SCD': 'Schedule',
            'MPR': 'Progress Report',
            'LIS': 'List/Index',
            'TBL': 'Table of Contents',
            'GA': 'General Arrangement',
            'SCH': 'Schematic',
            'CAL': 'Calculation',
            'DTS': 'Data Sheet',
            'CER': 'Certificate',
            'PHI': 'Philosophy/Description',
            'DWG': 'Drawing',
            'WIR': 'Wiring Diagram',
            'PDR': 'Procedure',
            'PLN': 'Plan',
            'ITP': 'Inspection & Test',
            'SPIR': 'Spare Parts',
            'RPT': 'Report',
            'MTC': 'Material Certificate',
            'INV': 'Invoice/Shipping',
            'IRN': 'Release Note',
            'RGT': 'Concession Record',
            'MOM': 'Meeting Minutes'
        };
        
        // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
        const defaultDocuments = [
            {"id": 1, "vdrs_code": "VDR", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-VDR-0001", "title": "SUPPLIER DOCUMENT REGISTER (SDR)", "status": "Active", "revision": "A"},
            {"id": 2, "vdrs_code": "SCD", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-SCD-0001", "title": "FABRICATION / PRODUCTION SCHEDULE", "status": "Active", "revision": "A"},
            {"id": 3, "vdrs_code": "MPR", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-MPR-0001", "title": "PROGRESS REPORTS", "status": "Active", "revision": "A"},
            {"id": 4, "vdrs_code": "LIS", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-LIS-0001", "title": "BOUGHT OUT ITEMS LIST/ VENDOR/ SUB-VENDOR CONTACT DIRECTORY", "status": "Active", "revision": "A"},
            {"id": 5, "vdrs_code": "TBL", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-TBL-0001", "title": "TABLE OF CONTENTS (ALL MANUALS)", "status": "Active", "revision": "A"},
            {"id": 6, "vdrs_code": "GA", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-GA-0001", "title": "GENERAL ARRANGEMENT", "status": "Active", "revision": "A"},
            {"id": 7, "vdrs_code": "SCH", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-SCH-0001", "title": "SCHEMATIC DIAGRAMS", "status": "Active", "revision": "A"},
            {"id": 8, "vdrs_code": "CAL", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-CAL-0001", "title": "UTILITIES CONSUMPTION", "status": "Active", "revision": "A"},
            {"id": 9, "vdrs_code": "DTS", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-DTS-0001", "title": "EQUIPMENT DATA SHEETS / WEIGHT DATA SHEETS", "status": "Active", "revision": "A"},
            {"id": 10, "vdrs_code": "CER", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-CER-0001", "title": "SCHEDULE OF Ex-CERTIFIED EQUIPMENT", "status": "Active", "revision": "A"},
            {"id": 11, "vdrs_code": "PHI", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-PHI-0001", "title": "DETAILED DESCRIPTION OF OPERATION", "status": "Active", "revision": "A"},
            {"id": 12, "vdrs_code": "LIS", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-LIS-0002", "title": "TELECOM INDEX", "status": "Active", "revision": "A"},
            {"id": 13, "vdrs_code": "DWG", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-DWG-0001", "title": "NAME PLATE FORMAT DRAWINGS", "status": "Active", "revision": "A"},
            {"id": 14, "vdrs_code": "DWG", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-DWG-0002", "title": "MISCELLANEOUS DRAWINGS", "status": "Active", "revision": "A"},
            {"id": 15, "vdrs_code": "DWG", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-DWG-0003", "title": "INST. ELEC. PANEL DETAIL DRAWINGS", "status": "Active", "revision": "A"},
            {"id": 16, "vdrs_code": "WIR", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-WIR-0001", "title": "TERMINATION DIAGRAM", "status": "Active", "revision": "A"},
            {"id": 17, "vdrs_code": "LIS", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-LIS-0003", "title": "CABLE SCHEDULE", "status": "Active", "revision": "A"},
            {"id": 18, "vdrs_code": "CAL", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-CAL-0002", "title": "HEAT EMISSION CALCULATION/ ENCLOSURE VENTILATION", "status": "Active", "revision": "A"},
            {"id": 19, "vdrs_code": "CAL", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-CAL-0003", "title": "RELIABILITY AVAILABILITY DATA & CALCULATIONS", "status": "Active", "revision": "A"},
            {"id": 20, "vdrs_code": "CER", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-CER-0002", "title": "PERFORMANCE GUARANTEE", "status": "Active", "revision": "A"},
            {"id": 21, "vdrs_code": "CAL", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-CAL-0004", "title": "RADIO PATH CALCULATION", "status": "Active", "revision": "A"},
            {"id": 22, "vdrs_code": "PDR", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-PDR-0001", "title": "ERECTION AND INSTALLATION PROCEDURES", "status": "Active", "revision": "A"},
            {"id": 23, "vdrs_code": "PDR", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-PDR-0002", "title": "UNPACKING AND PRESERVATION PROCEDURE", "status": "Active", "revision": "A"},
            {"id": 24, "vdrs_code": "PDR", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-PDR-0003", "title": "HANDLING AND SHIPPING PROCEDURES", "status": "Active", "revision": "A"},
            {"id": 25, "vdrs_code": "PDR", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-PDR-0004", "title": "PRE-COMMISSIONING / COMMISSIONING PROCEDURES", "status": "Active", "revision": "A"},
            {"id": 26, "vdrs_code": "CER", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-CER-0003", "title": "QUALITY MANAGEMENT SYSTEM CERTIFICATE", "status": "Active", "revision": "A"},
            {"id": 27, "vdrs_code": "PLN", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-PLN-0001", "title": "QUALITY PLAN", "status": "Active", "revision": "A"},
            {"id": 28, "vdrs_code": "ITP", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-ITP-0001", "title": "INSPECTION AND TEST PLAN", "status": "Active", "revision": "A"},
            {"id": 29, "vdrs_code": "PDR", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-PDR-0005", "title": "PERFORMANCE / ACCEPTANCE TEST PROCEDURE", "status": "Active", "revision": "A"},
            {"id": 30, "vdrs_code": "LIS", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-LIS-0004", "title": "PROPOSED SOFTWARE LISTING", "status": "Active", "revision": "A"},
            {"id": 31, "vdrs_code": "SPIR", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-SPIR-0001", "title": "RECOMMENDED START UP / COMMISSIONING SPARES", "status": "Active", "revision": "A"},
            {"id": 32, "vdrs_code": "SPIR", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-SPIR-0002", "title": "RECOMMENDED TWO YEAR OPERATING SPARES / PRICING", "status": "Active", "revision": "A"},
            {"id": 33, "vdrs_code": "LIS", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-LIS-0005", "title": "SPECIAL TOOL LIST", "status": "Active", "revision": "A"},
            {"id": 34, "vdrs_code": "RPT", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-RPT-0001", "title": "FACTORY ACCEPTANCE TEST REPORT", "status": "Active", "revision": "A"},
            {"id": 35, "vdrs_code": "CER", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-CER-0004", "title": "EQUIPMENT HAZARDOUS AREA CERTIFICATES", "status": "Active", "revision": "A"},
            {"id": 36, "vdrs_code": "RPT", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-RPT-0002", "title": "SITE ACCEPTANCE TEST (SAT) REPORT", "status": "Active", "revision": "A"},
            {"id": 37, "vdrs_code": "MTC", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-MTC-0001", "title": "MATERIAL TEST CERTIFICATE / MATERIAL TRACEABILITY", "status": "Active", "revision": "A"},
            {"id": 38, "vdrs_code": "RPT", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-RPT-0004", "title": "PAINTING / INSULATION INSPECTION REPORT", "status": "Active", "revision": "A"},
            {"id": 39, "vdrs_code": "INV", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-INV-0001", "title": "SHIPPING & PACKING DOCUMENTS", "status": "Active", "revision": "A"},
            {"id": 40, "vdrs_code": "CER", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-CER-0005", "title": "CERTIFICATE OF COMPLIANCE", "status": "Active", "revision": "A"},
            {"id": 41, "vdrs_code": "IRN", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-IRN-0001", "title": "RELEASE NOTE / NAME PLATE RUBBINGS/ PHOTOS", "status": "Active", "revision": "A"},
            {"id": 42, "vdrs_code": "RGT", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-CR-0001", "title": "CONCESSION RECORDS (SUPPLIER DEVIATION REQUEST)", "status": "Active", "revision": "A"},
            {"id": 43, "vdrs_code": "PDR", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-PDR-0006", "title": "SURFACE PREPARATION AND PAINTING PROCEDURE", "status": "Active", "revision": "A"},
            {"id": 44, "vdrs_code": "MOM", "doc_no": "TH-ART-3C-AWP39-TEQ-TEL-MOM-0001", "title": "KICK OF MEETING (KOM)", "status": "Active", "revision": "A"}
        ];
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadDocuments();
            setupEventListeners();
            populateCategoryFilter();
            populateVdrsCodeSelect();
        });
        
        // Setup Event Listeners
        function setupEventListeners() {
            document.getElementById('searchInput').addEventListener('input', filterDocuments);
            document.getElementById('categoryFilter').addEventListener('change', filterDocuments);
            document.getElementById('statusFilter').addEventListener('change', filterDocuments);
        }
        
        // Load Documents from LocalStorage
        function loadDocuments() {
            const stored = localStorage.getItem(STORAGE_KEY);
            if (stored) {
                documents = JSON.parse(stored);
            } else {
                // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô LocalStorage ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
                documents = defaultDocuments;
                saveToLocalStorage();
            }
            renderDocuments(documents);
            updateStats();
        }
        
        // Save to LocalStorage
        function saveToLocalStorage() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(documents));
        }
        
        // Populate Category Filter
        function populateCategoryFilter() {
            const select = document.getElementById('categoryFilter');
            select.innerHTML = '<option value="">All Categories</option>';
            
            // ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó
            const counts = {};
            documents.forEach(doc => {
                counts[doc.vdrs_code] = (counts[doc.vdrs_code] || 0) + 1;
            });
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏° options
            Object.keys(codeCategories).forEach(code => {
                if (counts[code]) {
                    const option = document.createElement('option');
                    option.value = code;
                    option.textContent = `${code} - ${codeCategories[code]} (${counts[code] || 0})`;
                    select.appendChild(option);
                }
            });
        }
        
        // Populate VDRS Code Select in Modal
        function populateVdrsCodeSelect() {
            const select = document.getElementById('vdrsCode');
            select.innerHTML = '<option value="">Select Code</option>';
            
            Object.keys(codeCategories).forEach(code => {
                const option = document.createElement('option');
                option.value = code;
                option.textContent = `${code} - ${codeCategories[code]}`;
                select.appendChild(option);
            });
        }
        
        // Render Documents Table
        function renderDocuments(docs) {
            const tbody = document.getElementById('tableBody');
            
            if (docs.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align:center; padding:2rem; color:#999;">No documents found</td></tr>';
                return;
            }
            
            tbody.innerHTML = docs.map(doc => `
                <tr>
                    <td>${doc.id}</td>
                    <td><span class="code-badge code-${doc.vdrs_code}">${doc.vdrs_code}</span></td>
                    <td><small>${doc.doc_no}</small></td>
                    <td>${doc.title}</td>
                    <td><span class="status-badge status-${doc.status.toLowerCase()}">${doc.status}</span></td>
                    <td>${doc.revision}</td>
                    <td>
                        <div class="actions">
                            <button class="btn-sm" onclick="editDocument(${doc.id})">‚úèÔ∏è</button>
                            <button class="btn-sm btn-danger" onclick="deleteDocument(${doc.id})">üóëÔ∏è</button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }
        
        // Filter Documents
        function filterDocuments() {
            const search = document.getElementById('searchInput').value.toLowerCase();
            const category = document.getElementById('categoryFilter').value;
            const status = document.getElementById('statusFilter').value;
            
            let filtered = documents;
            
            if (search) {
                filtered = filtered.filter(doc => 
                    doc.title.toLowerCase().includes(search) ||
                    doc.doc_no.toLowerCase().includes(search) ||
                    doc.vdrs_code.toLowerCase().includes(search)
                );
            }
            
            if (category) {
                filtered = filtered.filter(doc => doc.vdrs_code === category);
            }
            
            if (status) {
                filtered = filtered.filter(doc => doc.status === status);
            }
            
            renderDocuments(filtered);
        }
        
        // Update Statistics
        function updateStats() {
            document.getElementById('totalDocs').textContent = documents.length;
            document.getElementById('activeCount').textContent = documents.filter(d => d.status === 'Active').length;
            
            const uniqueCategories = new Set(documents.map(d => d.vdrs_code));
            document.getElementById('categoryCount').textContent = uniqueCategories.size;
        }
        
        // Show Add Modal
        function showAddModal() {
            document.getElementById('modalTitle').textContent = 'Add New Document';
            document.getElementById('documentForm').reset();
            document.getElementById('docId').value = '';
            document.getElementById('modal').classList.add('active');
        }
        
        // Edit Document
        function editDocument(id) {
            const doc = documents.find(d => d.id === id);
            if (doc) {
                document.getElementById('modalTitle').textContent = 'Edit Document';
                document.getElementById('docId').value = doc.id;
                document.getElementById('vdrsCode').value = doc.vdrs_code;
                document.getElementById('docNo').value = doc.doc_no;
                document.getElementById('docTitle').value = doc.title;
                document.getElementById('docStatus').value = doc.status;
                document.getElementById('docRevision').value = doc.revision;
                document.getElementById('modal').classList.add('active');
            }
        }
        
        // Save Document
        function saveDocument() {
            const id = document.getElementById('docId').value;
            const data = {
                vdrs_code: document.getElementById('vdrsCode').value,
                doc_no: document.getElementById('docNo').value,
                title: document.getElementById('docTitle').value,
                status: document.getElementById('docStatus').value,
                revision: document.getElementById('docRevision').value
            };
            
            if (!data.vdrs_code || !data.doc_no || !data.title) {
                alert('Please fill all required fields');
                return;
            }
            
            if (id) {
                // Update existing document
                const index = documents.findIndex(d => d.id == id);
                if (index !== -1) {
                    documents[index] = {...documents[index], ...data};
                    showSuccess('Document updated successfully');
                }
            } else {
                // Add new document
                const newId = documents.length > 0 ? Math.max(...documents.map(d => d.id)) + 1 : 1;
                documents.push({id: newId, ...data});
                showSuccess('Document added successfully');
            }
            
            saveToLocalStorage();
            loadDocuments();
            populateCategoryFilter();
            closeModal();
        }
        
        // Delete Document
        function deleteDocument(id) {
            if (!confirm('Are you sure you want to delete this document?')) return;
            
            documents = documents.filter(d => d.id !== id);
            saveToLocalStorage();
            loadDocuments();
            populateCategoryFilter();
            showSuccess('Document deleted successfully');
        }
        
        // Export to CSV
        function exportCSV() {
            let csv = 'ID,VDRS Code,Document No.,Title,Status,Revision\n';
            
            documents.forEach(doc => {
                csv += `${doc.id},"${doc.vdrs_code}","${doc.doc_no}","${doc.title}","${doc.status}","${doc.revision}"\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.setAttribute('hidden', '');
            a.setAttribute('href', url);
            a.setAttribute('download', 'vdrl_documents.csv');
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            showSuccess('CSV exported successfully');
        }
        
        // Export to JSON
        function exportJSON() {
            const json = JSON.stringify(documents, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.setAttribute('hidden', '');
            a.setAttribute('href', url);
            a.setAttribute('download', 'vdrl_documents.json');
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            showSuccess('JSON exported successfully');
        }
        
        // Close Modal
        function closeModal() {
            document.getElementById('modal').classList.remove('active');
            document.getElementById('documentForm').reset();
        }
        
        // Show Success Message
        function showSuccess(message) {
            const msgEl = document.getElementById('successMessage');
            const textEl = document.getElementById('successText');
            textEl.textContent = message;
            msgEl.classList.add('show');
            
            setTimeout(() => {
                msgEl.classList.remove('show');
            }, 3000);
        }
        
        // Modal click outside to close
        document.getElementById('modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
    </script>
</body>
</html>
