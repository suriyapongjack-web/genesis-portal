<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard ‡πÉ‡∏ö‡∏ï‡∏≠‡∏ö‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏´‡∏°‡∏≤ - ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ LAN 76 ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 30px;
            background: #f8f9fa;
        }

        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
            border-left: 5px solid #007bff;
            cursor: pointer;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
        }

        .stat-card.pending {
            border-left-color: #ffc107;
        }

        .stat-card.confirmed {
            border-left-color: #28a745;
        }

        .stat-card.multiple {
            border-left-color: #17a2b8;
        }

        .stat-card h3 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: #2c3e50;
            font-weight: 700;
        }

        .stat-card p {
            font-size: 1.1rem;
            color: #6c757d;
            font-weight: 500;
        }

        .controls {
            padding: 30px;
            background: white;
            border-bottom: 2px solid #e9ecef;
        }

        .control-row {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .search-group {
            display: flex;
            gap: 15px;
            flex: 1;
            min-width: 300px;
        }

        .form-control {
            padding: 12px 16px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
            outline: none;
        }

        .form-control:focus {
            border-color: #007bff;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .btn-primary {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
        }

        .btn-success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }

        .btn-warning {
            background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);
        }

        .btn-info {
            background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);
        }

        .export-section {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .table-container {
            padding: 30px;
            overflow-x: auto;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            font-size: 0.95rem;
        }

        .data-table thead {
            background: linear-gradient(135deg, #343a40 0%, #495057 100%);
            color: white;
        }

        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }

        .data-table th {
            font-weight: 600;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .data-table tbody tr {
            transition: background-color 0.2s ease;
            cursor: pointer;
        }

        .data-table tbody tr:hover {
            background: #f8f9fa;
        }

        .contractor-count {
            background: #f3e5f5;
            color: #7b1fa2;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-block;
        }

        .contractor-count:hover {
            background: #e1bee7;
            transform: scale(1.05);
        }

        .contractor-count.multiple {
            background: #e8f5e8;
            color: #2e7d32;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        .equipment-count {
            background: #e3f2fd;
            color: #1565c0;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            margin: 2px;
            display: inline-block;
        }

        .progress-container {
            background: white;
            margin: 20px 30px;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .progress-bar {
            background: #e9ecef;
            border-radius: 10px;
            height: 25px;
            overflow: hidden;
            margin-top: 15px;
            position: relative;
        }

        .progress-fill {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            height: 100%;
            transition: width 1s ease;
            position: relative;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .footer {
            background: #f8f9fa;
            padding: 20px 30px;
            text-align: center;
            color: #6c757d;
            border-top: 2px solid #e9ecef;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transform: translateX(300px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .notification.show {
            transform: translateX(0);
            opacity: 1;
        }

        .filter-info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 10px;
            color: #1565c0;
            font-weight: 500;
            display: none;
        }

        .badge-multiple {
            background: linear-gradient(45deg, #ff6b6b, #feca57);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
            margin-left: 8px;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }
            
            .control-row {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-group {
                min-width: auto;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }

            .export-section {
                justify-content: center;
            }

            .data-table {
                font-size: 0.8rem;
            }

            .data-table th,
            .data-table td {
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div id="notification" class="notification"></div>

    <div class="container">
        <div class="header">
            <h1>üè¢ Dashboard ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏´‡∏°‡∏≤‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</h1>
            <p>‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢ (LAN) 76 ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î - Add Value System Company Limited</p>
        </div>

        <div class="stats-grid">
            <div class="stat-card" onclick="filterByStatus('')">
                <h3 id="totalProvinces">76</h3>
                <p>üìç ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
            </div>
            <div class="stat-card confirmed" onclick="filterByStatus('hasContractors')">
                <h3 id="confirmedCount">4</h3>
                <p>‚úÖ ‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏ï‡∏≠‡∏ö‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß</p>
            </div>
            <div class="stat-card multiple" onclick="filterByStatus('multiple')">
                <h3 id="multipleCount">2</h3>
                <p>üë• ‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏´‡∏°‡∏≤‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏≤‡∏¢</p>
            </div>
            <div class="stat-card pending" onclick="filterByStatus('noContractors')">
                <h3 id="pendingCount">72</h3>
                <p>‚è≥ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏ï‡∏≠‡∏ö‡∏£‡∏±‡∏ö</p>
            </div>
            <div class="stat-card" onclick="filterByStatus('')">
                <h3 id="totalContractors">7</h3>
                <p>üè™ ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏´‡∏°‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
            </div>
            <div class="stat-card" onclick="filterByStatus('')">
                <h3 id="totalPoints">2,373</h3>
                <p>üîå ‡∏à‡∏∏‡∏î‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
            </div>
        </div>

        <div class="progress-container">
            <h3>üìä ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏´‡∏°‡∏≤</h3>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 5.3%">
                    <div class="progress-text" id="progressText">5.3%</div>
                </div>
            </div>
            <p style="margin-top: 10px; color: #6c757d; text-align: center;">
                <span id="progressPercent">5.3</span>% ‡∏Ç‡∏≠‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏´‡∏°‡∏≤‡∏ï‡∏≠‡∏ö‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß 
                (<span id="confirmedCountText">4</span> ‡∏à‡∏≤‡∏Å 76 ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î)
            </p>
        </div>

        <div class="controls">
            <div class="control-row">
                <div class="search-group">
                    <input type="text" id="searchInput" class="form-control" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î, ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó, ‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠..." oninput="applyFilters()">
                    <select id="statusFilter" class="form-control" onchange="applyFilters()">
                        <option value="">üìã ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                        <option value="hasContractors">‚úÖ ‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏ï‡∏≠‡∏ö‡∏£‡∏±‡∏ö</option>
                        <option value="multiple">üë• ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏´‡∏°‡∏≤‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏≤‡∏¢</option>
                        <option value="noContractors">‚è≥ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏ï‡∏≠‡∏ö‡∏£‡∏±‡∏ö</option>
                    </select>
                    <select id="regionFilter" class="form-control" onchange="applyFilters()">
                        <option value="">üó∫Ô∏è ‡∏†‡∏≤‡∏Ñ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                        <option value="north">‡∏†‡∏≤‡∏Ñ‡πÄ‡∏´‡∏ô‡∏∑‡∏≠</option>
                        <option value="northeast">‡∏†‡∏≤‡∏Ñ‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠</option>
                        <option value="central">‡∏†‡∏≤‡∏Ñ‡∏Å‡∏•‡∏≤‡∏á</option>
                        <option value="east">‡∏†‡∏≤‡∏Ñ‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å</option>
                        <option value="west">‡∏†‡∏≤‡∏Ñ‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏ï‡∏Å</option>
                        <option value="south">‡∏†‡∏≤‡∏Ñ‡πÉ‡∏ï‡πâ</option>
                    </select>
                </div>
                <div class="export-section">
                    <button class="btn btn-primary" onclick="exportToJSON()">üìÅ Export JSON</button>
                    <button class="btn btn-success" onclick="exportToCSV()">üìä Export CSV</button>
                    <button class="btn btn-warning" onclick="exportToPowerBI()">‚ö° Power BI Format</button>
                    <button class="btn btn-info" onclick="generateReport()">üìã ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
                </div>
            </div>
            <div id="filterInfo" class="filter-info"></div>
        </div>

        <div class="table-container">
            <table class="data-table" id="provincesTable">
                <thead>
                    <tr>
                        <th style="width: 60px;">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                        <th style="width: 120px;">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</th>
                        <th style="width: 100px;">‡∏†‡∏≤‡∏Ñ</th>
                        <th>‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ó‡∏µ‡∏°</th>
                        <th style="width: 80px;">‡∏à‡∏∏‡∏î‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á</th>
                        <th style="width: 80px;">Switch</th>
                        <th style="width: 80px;">Rack</th>
                        <th style="width: 150px;">‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏´‡∏°‡∏≤‡∏ï‡∏≠‡∏ö‡∏£‡∏±‡∏ö</th>
                        <th style="width: 120px;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                </tbody>
            </table>
        </div>

        <div class="footer">
            <p>üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó: <span id="updateDate"></span> | 
               üè¢ Add Value System Company Limited | 
               üìß addvalue-procurement@addvaluesystemcompany.onmicrosoft.com</p>
        </div>
    </div>

    <script>
        // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ó‡∏±‡πâ‡∏á 76 ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î
        var provincesData = [
            {id: 1, name: "‡∏Å‡∏£‡∏∞‡∏ö‡∏µ‡πà", region: "south", email: "addvalue-krabi@outlook.co.th", points: 29, switches: 2, racks: 1, lastUpdate: "2024-08-30", contractors: []},
            {id: 2, name: "‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ", region: "west", email: "addvalue-kanchanaburi@outlook.co.th", points: 34, switches: 2, racks: 1, lastUpdate: "2024-08-30", contractors: []},
            {id: 3, name: "‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå", region: "northeast", email: "addvalue-kalasin@outlook.co.th", points: 37, switches: 2, racks: 1, lastUpdate: "2024-08-30", contractors: []},
            {id: 4, name: "‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÄ‡∏û‡∏ä‡∏£", region: "north", email: "addvalue-kamphaengphet@outlook.co.th", points: 11, switches: 2, racks: 1, lastUpdate: "2024-08-30", contractors: []},
            {id: 5, name: "‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô", region: "northeast", email: "addvalue-khonkaen@outlook.co.th", points: 53, switches: 3, racks: 1, lastUpdate: "2024-08-30", contractors: [
                {id: 1, companyName: "‡∏ö‡∏à‡∏Å.‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ ‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô", contactPerson: "‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ", contactPhone: "089-123-4567", contactEmail: "somchai@techkk.com", lineId: "somchai_tech", experience: 5, status: "qualified", submittedDate: "2024-08-28", notes: "‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏á‡∏≤‡∏ô LAN ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 5 ‡∏õ‡∏µ"}
            ]},
            {id: 6, name: "‡∏à‡∏±‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ", region: "east", email: "addvalue-chanthaburi@outlook.co.th", points: 29, switches: 2, racks: 1, lastUpdate: "2024-08-30", contractors: []},
            {id: 7, name: "‡∏â‡∏∞‡πÄ‡∏ä‡∏¥‡∏á‡πÄ‡∏ó‡∏£‡∏≤", region: "central", email: "addvalue-chachoengsao@outlook.co.th", points: 31, switches: 2, racks: 1, lastUpdate: "2024-08-30", contractors: []},
            {id: 8, name: "‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ", region: "east", email: "addvalue-chonburi@outlook.co.th", points: 48, switches: 3, racks: 1, lastUpdate: "2024-08-30", contractors: [
                {id: 1, companyName: "‡∏´‡∏à‡∏Å.‡πÄ‡∏ô‡πá‡∏ï‡πÄ‡∏ß‡∏¥‡∏£‡πå‡∏Ñ ‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ", contactPerson: "‡∏ô‡∏≤‡∏¢‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤ ‡πÄ‡∏Å‡πà‡∏á‡∏Å‡∏≤‡∏à", contactPhone: "081-234-5678", contactEmail: "wittaya@netcb.com", lineId: "wittaya_net", experience: 7, status: "selected", submittedDate: "2024-08-25", notes: "‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡πÑ‡∏î‡πâ ‡∏°‡∏µ‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏î‡∏µ"},
                {id: 2, companyName: "‡∏ö‡∏à‡∏Å.‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï ‡∏û‡∏•‡∏±‡∏™", contactPerson: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏°‡∏ì‡∏µ ‡πÅ‡∏™‡∏á‡∏ó‡∏≠‡∏á", contactPhone: "092-345-6789", contactEmail: "manee@inetplus.com", lineId: "manee_iplus", experience: 4, status: "qualified", submittedDate: "2024-08-27", notes: "‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡πÑ‡∏î‡πâ‡πÅ‡∏ï‡πà‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤"},
                {id: 3, companyName: "‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡∏≠‡∏°‡∏Ø ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ", contactPerson: "‡∏ô‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡πÄ‡∏™‡∏£‡∏¥‡∏ê ‡∏ä‡∏≠‡∏ö‡∏á‡∏≤‡∏ô", contactPhone: "086-456-7890", contactEmail: "prasert@chokdee.com", lineId: "prasert_cd", experience: 2, status: "pending", submittedDate: "2024-08-29", notes: "‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô"}
            ]},
            {id: 9, name: "‡∏ä‡∏±‡∏¢‡∏ô‡∏≤‡∏ó", region: "central", email: "addvalue-chainat@outlook.co.th", points: 29, switches: 2, racks: 1, lastUpdate: "2024-08-30", contractors: []},
            {id: 10, name: "‡∏ä‡∏±‡∏¢‡∏†‡∏π‡∏°‡∏¥", region: "northeast", email: "addvalue-chaiyaphum@outlook.co.th", points: 34, switches: 2, racks: 1, lastUpdate: "2024-08-30", contractors: []},
            {id: 11, name: "‡∏ä‡∏∏‡∏°‡∏û‡∏£", region: "south", email: "addvalue-chumphon@outlook.co.th", points: 29, switches: 2, racks: 1, lastUpdate: "2024-08-30", contractors: []},
            {id: 12, name: "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢", region: "north", email: "addvalue-chiangrai@outlook.co.th", points: 38, switches: 2, racks: 1, lastUpdate: "2024-08-30", contractors: []},
            {id: 13, name: "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà", region: "north", email: "addvalue-chiangmai@outlook.co.th", points: 53, switches: 3, racks: 1, lastUpdate: "2024-08-30", contractors: [
                {id: 1, companyName: "‡∏ö‡∏à‡∏Å.‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡πÄ‡∏ó‡∏Ñ ‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ß‡∏¥‡∏™", contactPerson: "‡∏ô‡∏≤‡∏¢‡∏ä‡∏≥‡∏ô‡∏≤‡∏ç ‡∏£‡∏π‡πâ‡πÄ‡∏Å‡πà‡∏á", contactPhone: "053-123-456", contactEmail: "chamnan@northtech.com", lineId: "chamnan_nt", experience: 8, status: "selected", submittedDate: "2024-08-26", notes: "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏´‡∏°‡∏≤‡∏´‡∏•‡∏±‡∏Å‡πÅ‡∏•‡πâ‡∏ß"},
                {id: 2, companyName: "‡∏´‡∏à‡∏Å.‡∏î‡∏≠‡∏¢‡πÄ‡∏ó‡∏Ñ", contactPerson: "‡∏ô‡∏≤‡∏á‡∏™‡∏∏‡∏î‡∏≤ ‡∏Ç‡∏¢‡∏±‡∏ô‡∏ó‡∏≥", contactPhone: "053-234-567", contactEmail: "suda@doitech.com", lineId: "suda_dt", experience: 6, status: "backup", submittedDate: "2024-08-27", notes: "‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÄ‡∏õ‡πá‡∏ô backup contractor"}
            ]},
            {id: 14, name: "‡∏ï‡∏£‡∏±‡∏á", region: "south", email: "addvalue-trang@outlook.co.th", points: 29, switches: 2, racks: 1, lastUpdate: "2024-08-30", contractors: []},
            {id: 15, name: "‡∏ï‡∏£‡∏≤‡∏î", region: "east", email: "addvalue-trat@outlook.co.th", points: 29, switches: 2, racks: 1, lastUpdate: "2024-08-30", contractors: []},
            {id: 16, name: "‡∏ï‡∏≤‡∏Å", region: "north", email: "addvalue-tak@outlook.co.th", points: 29, switches: 2, racks: 1, lastUpdate: "2024-08-30", contractors: []},
            {id: 17, name: "‡∏ô‡∏Ñ‡∏£‡∏ô‡∏≤‡∏¢‡∏Å", region: "central", email: "addvalue-nakhonnayok@outlook.co.th", points: 29, switches: 2, racks: 1, lastUpdate: "2024-08-30", contractors: []},
            {id: 18, name: "‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°", region: "central", email: "addvalue-nakhonpathom@outlook.co.th", points: 34, switches: 2, racks: 1, lastUpdate: "2024-08-30", contractors: []},
            {id: 19, name: "‡∏ô‡∏Ñ‡∏£‡∏û‡∏ô‡∏°", region: "northeast", email: "addvalue-nakhonphanom@outlook.co.th", points: 11, switches: 2, racks: 1, lastUpdate: "2024-08-30", contractors: []},
            {id: 20, name: "‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤", region: "northeast", email: "addvalue-nakhonratchasima@outlook.co.th", points: 43, switches: 3, racks: 1, lastUpdate: "2024-08-30", contractors: [
                {id: 1, companyName: "‡∏ö‡∏à‡∏Å.‡πÇ‡∏Ñ‡∏£‡∏≤‡∏ä ‡πÄ‡∏ô‡πá‡∏ï‡πÄ‡∏ß‡∏¥‡∏£‡πå‡∏Ñ", contactPerson: "‡∏ô‡∏≤‡∏¢‡∏î‡∏≥‡∏£‡∏á‡∏Ñ‡πå ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç", contactPhone: "044-123-456", contactEmail: "damrong@koratnet.com", lineId: "damrong_kn", experience: 10, status: "qualified", submittedDate: "2024-08-24", notes: "‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏™‡∏π‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î"}
            ]}
        ];

        // ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠
        var remainingProvinces = [
            {name: "‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä", region: "south", points: 38},
            {name: "‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå", region: "north", points: 34},
            {name: "‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ", region: "central", points: 31},
            {name: "‡∏ô‡∏£‡∏≤‡∏ò‡∏¥‡∏ß‡∏≤‡∏™", region: "south", points: 29},
            {name: "‡∏ô‡πà‡∏≤‡∏ô", region: "north", points: 29},
            {name: "‡∏ö‡∏∂‡∏á‡∏Å‡∏≤‡∏¨", region: "northeast", points: 11},
            {name: "‡∏ö‡∏∏‡∏£‡∏µ‡∏£‡∏±‡∏°‡∏¢‡πå", region: "northeast", points: 38},
            {name: "‡∏õ‡∏ó‡∏∏‡∏°‡∏ò‡∏≤‡∏ô‡∏µ", region: "central", points: 34},
            {name: "‡∏õ‡∏£‡∏∞‡∏à‡∏ß‡∏ö‡∏Ñ‡∏µ‡∏£‡∏µ‡∏Ç‡∏±‡∏ô‡∏ò‡πå", region: "south", points: 29},
            {name: "‡∏õ‡∏£‡∏≤‡∏à‡∏µ‡∏ô‡∏ö‡∏∏‡∏£‡∏µ", region: "east", points: 29},
            {name: "‡∏õ‡∏±‡∏ï‡∏ï‡∏≤‡∏ô‡∏µ", region: "south", points: 11},
            {name: "‡∏û‡∏£‡∏∞‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏≠‡∏¢‡∏∏‡∏ò‡∏¢‡∏≤", region: "central", points: 34},
            {name: "‡∏û‡∏∞‡πÄ‡∏¢‡∏≤", region: "north", points: 29},
            {name: "‡∏û‡∏±‡∏á‡∏á‡∏≤", region: "south", points: 29},
            {name: "‡∏û‡∏±‡∏ó‡∏•‡∏∏‡∏á", region: "south", points: 29},
            {name: "‡∏û‡∏¥‡∏à‡∏¥‡∏ï‡∏£", region: "north", points: 29},
            {name: "‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å", region: "north", points: 34},
            {name: "‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏∏‡∏£‡∏µ", region: "central", points: 29},
            {name: "‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏π‡∏£‡∏ì‡πå", region: "north", points: 34},
            {name: "‡πÅ‡∏û‡∏£‡πà", region: "north", points: 29},
            {name: "‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï", region: "south", points: 29},
            {name: "‡∏°‡∏´‡∏≤‡∏™‡∏≤‡∏£‡∏Ñ‡∏≤‡∏°", region: "northeast", points: 34},
            {name: "‡∏°‡∏∏‡∏Å‡∏î‡∏≤‡∏´‡∏≤‡∏£", region: "northeast", points: 29},
            {name: "‡πÅ‡∏°‡πà‡∏Æ‡πà‡∏≠‡∏á‡∏™‡∏≠‡∏ô", region: "north", points: 29},
            {name: "‡∏¢‡πÇ‡∏™‡∏ò‡∏£", region: "northeast", points: 29},
            {name: "‡∏¢‡∏∞‡∏•‡∏≤", region: "south", points: 29},
            {name: "‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î", region: "northeast", points: 38},
            {name: "‡∏£‡∏∞‡∏ô‡∏≠‡∏á", region: "south", points: 29},
            {name: "‡∏£‡∏∞‡∏¢‡∏≠‡∏á", region: "east", points: 29},
            {name: "‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ", region: "west", points: 34},
            {name: "‡∏•‡∏û‡∏ö‡∏∏‡∏£‡∏µ", region: "central", points: 31},
            {name: "‡∏•‡∏≥‡∏õ‡∏≤‡∏á", region: "north", points: 29},
            {name: "‡∏•‡∏≥‡∏û‡∏π‡∏ô", region: "north", points: 29},
            {name: "‡πÄ‡∏•‡∏¢", region: "northeast", points: 29},
            {name: "‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©", region: "northeast", points: 38},
            {name: "‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£", region: "northeast", points: 34},
            {name: "‡∏™‡∏á‡∏Ç‡∏•‡∏≤", region: "south", points: 51},
            {name: "‡∏™‡∏ï‡∏π‡∏•", region: "south", points: 29},
            {name: "‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£", region: "central", points: 34},
            {name: "‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°", region: "central", points: 29},
            {name: "‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£", region: "central", points: 11},
            {name: "‡∏™‡∏£‡∏∞‡πÅ‡∏Å‡πâ‡∏ß", region: "east", points: 29},
            {name: "‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ", region: "central", points: 31},
            {name: "‡∏™‡∏¥‡∏á‡∏´‡πå‡∏ö‡∏∏‡∏£‡∏µ", region: "central", points: 29},
            {name: "‡∏™‡∏∏‡πÇ‡∏Ç‡∏ó‡∏±‡∏¢", region: "north", points: 29},
            {name: "‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì‡∏ö‡∏∏‡∏£‡∏µ", region: "central", points: 31},
            {name: "‡∏™‡∏∏‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏ò‡∏≤‡∏ô‡∏µ", region: "south", points: 34},
            {name: "‡∏™‡∏∏‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå", region: "northeast", points: 38},
            {name: "‡∏´‡∏ô‡∏≠‡∏á‡∏Ñ‡∏≤‡∏¢", region: "northeast", points: 29},
            {name: "‡∏´‡∏ô‡∏≠‡∏á‡∏ö‡∏±‡∏ß‡∏•‡∏≥‡∏†‡∏π", region: "northeast", points: 29},
            {name: "‡∏≠‡πà‡∏≤‡∏á‡∏ó‡∏≠‡∏á", region: "central", points: 29},
            {name: "‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡πÄ‡∏à‡∏£‡∏¥‡∏ç", region: "northeast", points: 29},
            {name: "‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ", region: "northeast", points: 38},
            {name: "‡∏≠‡∏∏‡∏ï‡∏£‡∏î‡∏¥‡∏ï‡∏ñ‡πå", region: "north", points: 29},
            {name: "‡∏≠‡∏∏‡∏ó‡∏±‡∏¢‡∏ò‡∏≤‡∏ô‡∏µ", region: "north", points: 29},
            {name: "‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ", region: "northeast", points: 39}
        ];

        // ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠
        for (var i = 0; i < remainingProvinces.length; i++) {
            var province = remainingProvinces[i];
            provincesData.push({
                id: 21 + i,
                name: province.name,
                region: province.region,
                email: "addvalue-" + province.name.toLowerCase() + "@outlook.co.th",
                points: province.points,
                switches: province.points > 40 ? 3 : 2,
                racks: 1,
                lastUpdate: "2024-08-30",
                contractors: []
            });
        }

        var filteredData = provincesData.slice();

        var regionNames = {
            "north": "‡∏†‡∏≤‡∏Ñ‡πÄ‡∏´‡∏ô‡∏∑‡∏≠",
            "northeast": "‡∏†‡∏≤‡∏Ñ‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠", 
            "central": "‡∏†‡∏≤‡∏Ñ‡∏Å‡∏•‡∏≤‡∏á",
            "east": "‡∏†‡∏≤‡∏Ñ‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å",
            "west": "‡∏†‡∏≤‡∏Ñ‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏ï‡∏Å",
            "south": "‡∏†‡∏≤‡∏Ñ‡πÉ‡∏ï‡πâ"
        };

        function updateStats() {
            var provincesWithContractors = 0;
            var provincesWithMultiple = 0;
            var totalContractors = 0;
            var totalPoints = 0;

            for (var i = 0; i < provincesData.length; i++) {
                var p = provincesData[i];
                if (p.contractors.length > 0) {
                    provincesWithContractors++;
                }
                if (p.contractors.length > 1) {
                    provincesWithMultiple++;
                }
                totalContractors += p.contractors.length;
                totalPoints += p.points;
            }

            var pendingProvinces = provincesData.length - provincesWithContractors;

            document.getElementById('confirmedCount').textContent = provincesWithContractors;
            document.getElementById('multipleCount').textContent = provincesWithMultiple;
            document.getElementById('pendingCount').textContent = pendingProvinces;
            document.getElementById('totalContractors').textContent = totalContractors;
            document.getElementById('totalPoints').textContent = totalPoints.toLocaleString();

            var progressPercent = Math.round((provincesWithContractors / provincesData.length) * 100);
            document.getElementById('progressPercent').textContent = progressPercent;
            document.getElementById('confirmedCountText').textContent = provincesWithContractors;
            document.getElementById('progressFill').style.width = progressPercent + '%';
            document.getElementById('progressText').textContent = progressPercent + '%';
        }

        function getContractorDisplay(province) {
            var count = province.contractors.length;
            if (count === 0) {
                return '<span class="contractor-count">‚è≥ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏ï‡∏≠‡∏ö‡∏£‡∏±‡∏ö</span>';
            } else if (count === 1) {
                return '<span class="contractor-count">‚úÖ ' + count + ' ‡∏£‡∏≤‡∏¢</span>';
            } else {
                return '<span class="contractor-count multiple">üë• ' + count + ' ‡∏£‡∏≤‡∏¢<span class="badge-multiple">Multiple!</span></span>';
            }
        }

        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString('th-TH');
        }

        function populateTable(data) {
            if (!data) data = filteredData;
            
            var tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            if (data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="9" style="text-align: center; padding: 40px; color: #6c757d;">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</td></tr>';
                return;
            }

            for (var i = 0; i < data.length; i++) {
                var province = data[i];
                var row = tbody.insertRow();
                var contractorDisplay = getContractorDisplay(province);
                
                row.innerHTML = 
                    '<td style="text-align: center; font-weight: bold;">' + (i + 1) + '</td>' +
                    '<td style="font-weight: bold; color: #2c3e50;">' + province.name + '</td>' +
                    '<td><span style="background: #e3f2fd; color: #1565c0; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem;">' + regionNames[province.region] + '</span></td>' +
                    '<td style="font-size: 0.85rem; color: #6c757d;">' + province.email + '</td>' +
                    '<td><span class="equipment-count">' + province.points + ' ‡∏à‡∏∏‡∏î</span></td>' +
                    '<td><span class="equipment-count">' + province.switches + ' ‡∏ï‡∏±‡∏ß</span></td>' +
                    '<td><span class="equipment-count">' + province.racks + ' ‡∏ï‡∏π‡πâ</span></td>' +
                    '<td>' + contractorDisplay + '</td>' +
                    '<td style="font-size: 0.8rem; color: #6c757d;">' + formatDate(province.lastUpdate) + '</td>';
            }

            updateFilterInfo(data.length);
        }

        function updateFilterInfo(count) {
            var filterInfo = document.getElementById('filterInfo');
            var searchTerm = document.getElementById('searchInput').value;
            var statusFilter = document.getElementById('statusFilter').value;
            var regionFilter = document.getElementById('regionFilter').value;

            if (searchTerm || statusFilter || regionFilter || count < provincesData.length) {
                var info = '‡πÅ‡∏™‡∏î‡∏á ' + count.toLocaleString() + ' ‡∏à‡∏≤‡∏Å ' + provincesData.length + ' ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î';
                if (searchTerm) info += ' | ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤: "' + searchTerm + '"';
                if (statusFilter) {
                    var statusLabels = {
                        'hasContractors': '‚úÖ ‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏ï‡∏≠‡∏ö‡∏£‡∏±‡∏ö',
                        'multiple': 'üë• ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏´‡∏°‡∏≤‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏≤‡∏¢',
                        'noContractors': '‚è≥ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏ï‡∏≠‡∏ö‡∏£‡∏±‡∏ö'
                    };
                    info += ' | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ' + statusLabels[statusFilter];
                }
                if (regionFilter) info += ' | ‡∏†‡∏≤‡∏Ñ: ' + regionNames[regionFilter];
                
                filterInfo.textContent = info;
                filterInfo.style.display = 'block';
            } else {
                filterInfo.style.display = 'none';
            }
        }

        function applyFilters() {
            var searchTerm = document.getElementById('searchInput').value.toLowerCase();
            var statusFilter = document.getElementById('statusFilter').value;
            var regionFilter = document.getElementById('regionFilter').value;

            filteredData = [];

            for (var i = 0; i < provincesData.length; i++) {
                var province = provincesData[i];
                
                var matchesSearch = province.name.toLowerCase().indexOf(searchTerm) !== -1 || 
                                   province.email.toLowerCase().indexOf(searchTerm) !== -1;

                for (var j = 0; j < province.contractors.length; j++) {
                    var c = province.contractors[j];
                    if (c.companyName.toLowerCase().indexOf(searchTerm) !== -1 ||
                        c.contactPerson.toLowerCase().indexOf(searchTerm) !== -1) {
                        matchesSearch = true;
                        break;
                    }
                }
                
                var matchesStatus = true;
                if (statusFilter) {
                    if (statusFilter === 'hasContractors') {
                        matchesStatus = province.contractors.length > 0;
                    } else if (statusFilter === 'multiple') {
                        matchesStatus = province.contractors.length > 1;
                    } else if (statusFilter === 'noContractors') {
                        matchesStatus = province.contractors.length === 0;
                    }
                }

                var matchesRegion = !regionFilter || province.region === regionFilter;

                if (matchesSearch && matchesStatus && matchesRegion) {
                    filteredData.push(province);
                }
            }

            populateTable(filteredData);
        }

        function filterByStatus(status) {
            document.getElementById('statusFilter').value = status;
            applyFilters();
            showNotification('‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢');
        }

        function showNotification(message) {
            var notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            
            setTimeout(function() {
                notification.classList.remove('show');
            }, 3000);
        }

        function downloadFile(content, filename, contentType) {
            var a = document.createElement('a');
            var file = new Blob([content], {type: contentType});
            a.href = URL.createObjectURL(file);
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        function exportToJSON() {
            var dataStr = JSON.stringify(provincesData, null, 2);
            downloadFile(dataStr, 'provinces_contractors_full.json', 'application/json');
            showNotification('‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• JSON ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
        }

        function exportToCSV() {
            var csvContent = '\ufeffID,‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î,‡∏†‡∏≤‡∏Ñ,‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ó‡∏µ‡∏°,‡∏à‡∏∏‡∏î‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á,Switch,Rack,‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏´‡∏°‡∏≤,‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó\n';

            for (var i = 0; i < provincesData.length; i++) {
                var p = provincesData[i];
                csvContent += p.id + ',"' + p.name + '","' + regionNames[p.region] + '","' + p.email + '",' + p.points + ',' + p.switches + ',' + p.racks + ',' + p.contractors.length + ',' + p.lastUpdate + '\n';
            }
            
            downloadFile(csvContent, 'provinces_contractors_full.csv', 'text/csv;charset=utf-8;');
            showNotification('‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• CSV ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
        }

        function exportToPowerBI() {
            var powerBIData = [];

            for (var i = 0; i < provincesData.length; i++) {
                var p = provincesData[i];
                if (p.contractors.length === 0) {
                    powerBIData.push({
                        ProvinceID: p.id,
                        ProvinceName: p.name,
                        Region: p.region,
                        RegionName: regionNames[p.region],
                        TeamEmail: p.email,
                        InstallationPoints: p.points,
                        SwitchCount: p.switches,
                        RackCount: p.racks,
                        ContractorsCount: 0,
                        HasContractors: false,
                        HasMultipleContractors: false,
                        LastUpdated: p.lastUpdate,
                        CreatedDate: new Date().toISOString(),
                        ProjectName: '‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢ (LAN) 76 ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î'
                    });
                } else {
                    for (var j = 0; j < p.contractors.length; j++) {
                        var c = p.contractors[j];
                        powerBIData.push({
                            ProvinceID: p.id,
                            ProvinceName: p.name,
                            Region: p.region,
                            RegionName: regionNames[p.region],
                            TeamEmail: p.email,
                            InstallationPoints: p.points,
                            SwitchCount: p.switches,
                            RackCount: p.racks,
                            ContractorsCount: p.contractors.length,
                            HasContractors: true,
                            HasMultipleContractors: p.contractors.length > 1,
                            ContractorCompany: c.companyName,
                            ContactPerson: c.contactPerson,
                            ContactPhone: c.contactPhone,
                            ContactEmail: c.contactEmail,
                            ContractorStatus: c.status,
                            Experience: c.experience,
                            SubmittedDate: c.submittedDate,
                            Notes: c.notes,
                            LastUpdated: p.lastUpdate,
                            CreatedDate: new Date().toISOString(),
                            ProjectName: '‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢ (LAN) 76 ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î'
                        });
                    }
                }
            }

            var dataStr = JSON.stringify(powerBIData, null, 2);
            downloadFile(dataStr, 'contractors_powerbi_format.json', 'application/json');
            showNotification('‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Power BI Format ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
        }

        function generateReport() {
            var provincesWithContractors = 0;
            var totalContractors = 0;

            for (var i = 0; i < provincesData.length; i++) {
                if (provincesData[i].contractors.length > 0) {
                    provincesWithContractors++;
                }
                totalContractors += provincesData[i].contractors.length;
            }
            
            var reportData = {
                metadata: {
                    reportTitle: '‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏´‡∏°‡∏≤‡∏ï‡∏≠‡∏ö‡∏£‡∏±‡∏ö - ‡∏£‡∏≤‡∏¢‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î',
                    projectName: '‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢ (LAN) 76 ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î',
                    company: 'Add Value System Company Limited',
                    generatedDate: new Date().toISOString()
                },
                summary: {
                    totalProvinces: provincesData.length,
                    provincesWithContractors: provincesWithContractors,
                    totalContractors: totalContractors,
                    progressPercentage: Math.round((provincesWithContractors / provincesData.length) * 100)
                },
                detailedData: provincesData.map(function(p) {
                    return {
                        id: p.id,
                        name: p.name,
                        region: regionNames[p.region],
                        email: p.email,
                        points: p.points,
                        switches: p.switches,
                        racks: p.racks,
                        contractorsCount: p.contractors.length,
                        lastUpdate: p.lastUpdate
                    };
                })
            };

            var dataStr = JSON.stringify(reportData, null, 2);
            downloadFile(dataStr, 'contractors_detailed_report.json', 'application/json');
            showNotification('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
        }

        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
        window.onload = function() {
            updateStats();
            populateTable();
            
            document.getElementById('updateDate').textContent = new Date().toLocaleDateString('th-TH', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            setTimeout(function() {
                showNotification('Dashboard ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô - ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‡∏Å‡∏£‡∏≠‡∏á ‡πÅ‡∏•‡∏∞ Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ!');
            }, 1000);
        };
    </script>
</body>
</html>